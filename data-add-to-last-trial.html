<!doctype html>
<html>

<head>
  <script src="scripts/jquery.min.js"></script>
  <script src="scripts/jspsych.js"></script>
  <script src="plugins/jspsych-single-stim.js"></script>
  <link rel="stylesheet" href="styles/jspsych.css"/>
  <style>
    img {
      width: 300px;
    }
  </style>
</head>

<body>
  <div id="loader" class="centert">Loading</div>
  <div id="jspsych-target"></div>
</body>
<script>
  var dots = 0;
  //var loading = setInterval(animateLoader, 100);
 // var checkForLoad = setInterval(waitForConnection, 500);

  var block_1 = {
    type: 'single-stim',
    stimulus: 'images/happy_face_1.jpg',
    choices: [89, 78], // Y or N
    prompt: '<p class="center-content">Have you seen this face before? Y or N.</p>',
    on_finish: function() {
      jsPsych.data.addDataToLastTrial({
        correct: true,
        sample: $.get('/brainScan')


      });



    }
  };


  function waitForConnection(){

      if($.get('/brainConnected') === true){
          clearInterval(loading);
          clearInterval(checkForLoad);



      }



  }

  jsPsych.init({
      display_element: $('#jspsych-target'),
      timeline: [block_1],
      on_finish: function() {
          jsPsych.data.displayData();
      }
  });




  function animateLoader(){
      if(dots == 3){
          dots = 0;
          $('#loader').text('Loader');
      }else {
          dots++;
          $('#loader').appendText('.')
      }
  }




</script>

</html>
